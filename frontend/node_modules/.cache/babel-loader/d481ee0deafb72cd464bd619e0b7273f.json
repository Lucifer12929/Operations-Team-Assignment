{"ast":null,"code":"import _regeneratorRuntime from\"D:/Project/Operations Team/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/Project/Operations Team/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import\"./App.css\";import{BrowserRouter as Router,Switch,Route}from\"react-router-dom\";import React,{useEffect}from\"react\";import{useDispatch,useSelector}from\"react-redux\";// import \"antd/dist/antd.css\";\nimport Register from\"./components/register\";import Activate from\"./components/activate\";import axios from\"axios\";import{dispatchLogin,dispatchGetUser,fetchUser}from\"./redux/action/authAction\";import NotFound from\"./utils/NotFound/NotFound\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function App(){var dispatch=useDispatch();var token=useSelector(function(state){return state.token;});var auth=useSelector(function(state){return state.auth;});var isLogged=auth.isLogged;useEffect(function(){var firstLogin=localStorage.getItem(\"firstLogin\");if(firstLogin){var getToken=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.post(\"/user/refresh_token\",null);case 2:res=_context.sent;dispatch({type:\"GET_TOKEN\",payload:res.data.access_token});case 4:case\"end\":return _context.stop();}}},_callee);}));return function getToken(){return _ref.apply(this,arguments);};}();getToken();}},[auth.isLogged,dispatch]);useEffect(function(){if(token){var getUser=function getUser(){dispatch(dispatchLogin());return fetchUser(token).then(function(res){dispatch(dispatchGetUser(res));});};getUser();}},[token,dispatch]);return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"main\",children:/*#__PURE__*/_jsx(Router,{children:/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsx(Route,{exact:true,path:\"/\",component:isLogged?NotFound:Register}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/activated\",component:Activate}),/*#__PURE__*/_jsx(Route,{component:NotFound})]})})})})});}export default App;","map":{"version":3,"names":["BrowserRouter","Router","Switch","Route","React","useEffect","useDispatch","useSelector","Register","Activate","axios","dispatchLogin","dispatchGetUser","fetchUser","NotFound","App","dispatch","token","state","auth","isLogged","firstLogin","localStorage","getItem","getToken","post","res","type","payload","data","access_token","getUser","then"],"sources":["D:/Project/Operations Team/frontend/src/App.js"],"sourcesContent":["import \"./App.css\";\nimport { BrowserRouter as Router, Switch, Route } from \"react-router-dom\";\nimport React, { useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\n// import \"antd/dist/antd.css\";\n\nimport Register from \"./components/register\";\nimport Activate from \"./components/activate\";\nimport axios from \"axios\";\n\nimport {\n  dispatchLogin,\n  dispatchGetUser,\n  fetchUser,\n} from \"./redux/action/authAction\";\n\nimport NotFound from \"./utils/NotFound/NotFound\";\n\n\n\nfunction App() {\n  const dispatch = useDispatch();\n  const token = useSelector((state) => state.token);\n  const auth = useSelector((state) => state.auth);\n  const { isLogged } = auth;\n\n  useEffect(() => {\n    const firstLogin = localStorage.getItem(\"firstLogin\");\n    if (firstLogin) {\n      const getToken = async () => {\n        const res = await axios.post(\"/user/refresh_token\", null);\n        dispatch({ type: \"GET_TOKEN\", payload: res.data.access_token });\n      };\n      getToken();\n    }\n  }, [auth.isLogged, dispatch]);\n\n  useEffect(() => {\n    if (token) {\n      const getUser = () => {\n        dispatch(dispatchLogin());\n        return fetchUser(token).then((res) => {\n          dispatch(dispatchGetUser(res));\n        });\n      };\n      getUser();\n    }\n  }, [token, dispatch]);\n  return (\n    <>\n      <div className=\"main\">\n        <Router>\n          <>\n            <Switch>\n              <Route\n                exact\n                path=\"/\"\n                component={isLogged ? NotFound : Register}\n              />\n              {/* <Route\n                exact\n                path=\"/contact\"\n                component={isLogged ? NotFound : Contact}\n              />\n              <Route\n                exact\n                path=\"/user/activate/:activation_token\"\n                component={ActivationEmail}\n              /> */}\n               <Route\n                exact\n                path=\"/activated\"\n                component={ Activate}\n              />\n              <Route component={NotFound} />\n            </Switch>\n          </>\n        </Router>\n        \n      </div>\n    </>\n  );\n}\n\nexport default App;"],"mappings":"kQAAA,MAAO,WAAW,CAClB,OAASA,aAAa,GAAIC,OAAM,CAAEC,MAAM,CAAEC,KAAK,KAAQ,kBAAkB,CACzE,MAAOC,MAAK,EAAIC,SAAS,KAAQ,OAAO,CACxC,OAASC,WAAW,CAAEC,WAAW,KAAQ,aAAa,CACtD;AAEA,MAAOC,SAAQ,KAAM,uBAAuB,CAC5C,MAAOC,SAAQ,KAAM,uBAAuB,CAC5C,MAAOC,MAAK,KAAM,OAAO,CAEzB,OACEC,aAAa,CACbC,eAAe,CACfC,SAAS,KACJ,2BAA2B,CAElC,MAAOC,SAAQ,KAAM,2BAA2B,CAAC,6IAIjD,QAASC,IAAG,EAAG,CACb,GAAMC,SAAQ,CAAGV,WAAW,EAAE,CAC9B,GAAMW,MAAK,CAAGV,WAAW,CAAC,SAACW,KAAK,QAAKA,MAAK,CAACD,KAAK,GAAC,CACjD,GAAME,KAAI,CAAGZ,WAAW,CAAC,SAACW,KAAK,QAAKA,MAAK,CAACC,IAAI,GAAC,CAC/C,GAAQC,SAAQ,CAAKD,IAAI,CAAjBC,QAAQ,CAEhBf,SAAS,CAAC,UAAM,CACd,GAAMgB,WAAU,CAAGC,YAAY,CAACC,OAAO,CAAC,YAAY,CAAC,CACrD,GAAIF,UAAU,CAAE,CACd,GAAMG,SAAQ,4FAAG,mKACGd,MAAK,CAACe,IAAI,CAAC,qBAAqB,CAAE,IAAI,CAAC,QAAnDC,GAAG,eACTV,QAAQ,CAAC,CAAEW,IAAI,CAAE,WAAW,CAAEC,OAAO,CAAEF,GAAG,CAACG,IAAI,CAACC,YAAa,CAAC,CAAC,CAAC,sDACjE,kBAHKN,SAAQ,0CAGb,CACDA,QAAQ,EAAE,CACZ,CACF,CAAC,CAAE,CAACL,IAAI,CAACC,QAAQ,CAAEJ,QAAQ,CAAC,CAAC,CAE7BX,SAAS,CAAC,UAAM,CACd,GAAIY,KAAK,CAAE,CACT,GAAMc,QAAO,CAAG,QAAVA,QAAO,EAAS,CACpBf,QAAQ,CAACL,aAAa,EAAE,CAAC,CACzB,MAAOE,UAAS,CAACI,KAAK,CAAC,CAACe,IAAI,CAAC,SAACN,GAAG,CAAK,CACpCV,QAAQ,CAACJ,eAAe,CAACc,GAAG,CAAC,CAAC,CAChC,CAAC,CAAC,CACJ,CAAC,CACDK,OAAO,EAAE,CACX,CACF,CAAC,CAAE,CAACd,KAAK,CAAED,QAAQ,CAAC,CAAC,CACrB,mBACE,sCACE,YAAK,SAAS,CAAC,MAAM,uBACnB,KAAC,MAAM,wBACL,sCACE,MAAC,MAAM,yBACL,KAAC,KAAK,EACJ,KAAK,MACL,IAAI,CAAC,GAAG,CACR,SAAS,CAAEI,QAAQ,CAAGN,QAAQ,CAAGN,QAAS,EAC1C,cAWD,KAAC,KAAK,EACL,KAAK,MACL,IAAI,CAAC,YAAY,CACjB,SAAS,CAAGC,QAAS,EACrB,cACF,KAAC,KAAK,EAAC,SAAS,CAAEK,QAAS,EAAG,GACvB,EACR,EACI,EAEL,EACL,CAEP,CAEA,cAAeC,IAAG"},"metadata":{},"sourceType":"module"}